'''
Created on 13th,March,2018

@author: Alvin Ye
'''
from dbcParser.dbcParser import dbcParser
from CanMsgLayoutDecoder.CanMsgLayoutDecoder import CanMsgLayoutDecoder

if __name__ == "__main__":
    import sys
    myParser = dbcParser()
#     try:
    myParser.parseDbc(sys.argv[1])
    print('INFO: dbc parsing succeed')
    with open(sys.argv[2],'w') as f:
        for msg in myParser._canNetwork.Nodes['ESCL'].NodeTxMsgs.values():
            for signalName,signal in CanMsgLayoutDecoder(msg).createLayout().items():
                print(signalName,signal.SignalStartBit,signal.SignalLength)
                #f.write(signalName+'\t'+str(signal.SignalStartBit)+'\t'+str(signal.SignalLength)+'\n')
        print("file generation succeed")
#     except UnicodeDecodeError:
#         print("dbc decoding error, please convert dbc to utf-8 first")
#     except KeyError:
#         print("input the correct name of ESCL")
#     except:
#         print("ERROR: no dbc file designated")
